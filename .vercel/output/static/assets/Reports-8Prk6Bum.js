import{s as e,j as t,m as r,F as a,c as s,A as o,H as n,Z as i,D as l}from"./index-D6X-thcP.js";import{r as d}from"./react-vendor-Dq_i0H7_.js";import{P as c}from"./plus-DytL0S77.js";import{M as x}from"./message-square-DUZfLLqc.js";import"./supabase-D2F8Vsqq.js";function m({onNavigate:i}){const[l,x]=d.useState([]),[m,p]=d.useState(!0),[b,y]=d.useState(null),[u,f]=d.useState(!1);async function j(){try{const{data:{user:t}}=await e.auth.getUser();if(!t)return;const{data:r,error:a}=await e.from("health_reports").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;x(r||[])}catch(t){}finally{p(!1)}}d.useEffect(()=>{j()},[]);const N=e=>{switch(e){case"general":return"General Report";case"thematic":return"Thematic";case"dynamic":return"Dynamic";case"device_enhanced":return"Device Enhanced";default:return e}};return u?t.jsx(h,{onBack:()=>f(!1),onComplete:()=>{f(!1),j()}}):b?t.jsx(g,{report:b,onBack:()=>y(null),onNavigate:i}):m?t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(r,{className:"h-12 w-12 text-orange-500 mx-auto mb-4 animate-spin"}),t.jsx("p",{className:"text-gray-400",children:"Loading your reports..."})]})}):t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16",children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[t.jsxs("div",{className:"mb-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h1",{className:"text-4xl font-bold text-white",children:"My Reports"}),t.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-600 shadow-lg shadow-orange-600/20 text-white rounded-lg transition-colors",children:[t.jsx(c,{className:"h-5 w-5 mr-2"}),"Create Report"]})]}),t.jsx("p",{className:"text-xl text-gray-400",children:"Reports transform data into understanding: what's happening now, why, and what to do next."})]}),0===l.length?t.jsxs("div",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-12 text-center border-2 border-dashed border-gray-700/50",children:[t.jsx(a,{className:"h-16 w-16 text-orange-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No reports yet"}),t.jsx("p",{className:"text-gray-400 mb-6 max-w-md mx-auto",children:"Create your first report to get a personalized explanation of your state and specific steps for improvement."}),t.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-600 shadow-lg shadow-orange-600/20 text-white rounded-lg transition-colors font-semibold",children:[t.jsx(c,{className:"h-5 w-5 mr-2"}),"Create First Report"]})]}):t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(e=>{const r=(e=>{switch(e){case"general":default:return a;case"thematic":return n;case"dynamic":return s;case"device_enhanced":return o}})(e.report_type);return t.jsxs("div",{onClick:()=>y(e),className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700/50 hover:border-blue-300 dark:hover:border-blue-700 transition-all cursor-pointer group",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx(r,{className:"h-6 w-6 text-orange-500"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:e.topic||N(e.report_type)}),t.jsx("p",{className:"text-sm text-gray-400",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]})]}),t.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 text-xs font-semibold rounded",children:N(e.report_type)})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4 line-clamp-3",children:e.summary}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400",children:[e.insights&&Array.isArray(e.insights)&&t.jsxs("span",{children:[e.insights.length," insights"]}),e.recommendations&&Array.isArray(e.recommendations)&&t.jsxs("span",{children:[e.recommendations.length," recommendations"]}),e.second_opinion_a&&e.second_opinion_b&&t.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:"+ Second Opinion"})]}),t.jsx(s,{className:"h-5 w-5 text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"})]})]},e.id)})})]})})}function h({onBack:r,onComplete:l}){const[c,x]=d.useState("type"),[m,h]=d.useState("general"),[g,p]=d.useState(!1),[b,y]=d.useState(""),u=async()=>{x("generating");try{const{data:{user:t}}=await e.auth.getUser();if(!t)return;const r={user_id:t.id,report_type:m,topic:b||null,summary:"Your body is currently in a stabilization state. Sleep is supporting recovery, but your nervous system hasn't returned to normal tone yet.",insights:["Sleep quality is stable, duration within normal range","HRV shows slight decrease over the last 3 days","Energy remains steady, small drops after lunch","Physical activity in adaptive zone"],analysis:"Your body is functioning well overall. Sleep metrics are adequate, but there's room for deeper recovery. HRV shows a slight drop - a signal of mild stress on the nervous system. Energy drops after lunch, which may be related to nutrition or lack of brief rest.",recommendations:[{title:"Recovery Practices",description:"Add 10 minutes of breathing exercises before bed. This will lower nervous system tension.",priority:"high"},{title:"Eating Pattern",description:"Reduce carbohydrate load at lunch, add more protein and fiber.",priority:"medium"},{title:"Short Walk",description:"Take a 10-15 minute walk after lunch to stabilize glucose levels.",priority:"medium"}],device_data:null};g&&(r.second_opinion_a="Your state is related to a slight decrease in parasympathetic activity. HRV drops due to insufficient recovery between stressful periods. This is a normal adaptive response, but it's important not to allow chronic overload.",r.second_opinion_b="It looks like you've picked up a slightly fast pace and your body is trying to catch up. This doesn't mean you need to stop - just add pauses between efforts. The body adapts better when load and recovery alternate.");const{error:a}=await e.from("health_reports").insert(r);if(a)throw a;setTimeout(()=>{l()},2e3)}catch(t){x("options")}};return"generating"===c?t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16 flex items-center justify-center",children:t.jsxs("div",{className:"text-center max-w-md",children:[t.jsx(i,{className:"h-16 w-16 text-orange-500 mx-auto mb-6 animate-pulse"}),t.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Creating your report"}),t.jsxs("div",{className:"space-y-2 text-gray-400",children:[t.jsx("p",{children:"✓ Gathering latest data"}),t.jsx("p",{children:"✓ Analyzing trends"}),t.jsx("p",{children:"✓ Forming insights"}),t.jsx("p",{className:"animate-pulse",children:"⏳ Preparing recommendations..."})]})]})}):"options"===c?t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16",children:t.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[t.jsx("button",{onClick:r,className:"mb-6 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"← Back"}),t.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"Report Settings"}),t.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 mb-8 border border-gray-700/50",children:t.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"We'll gather your latest data and present the observations in a clear format: what's happening now, why, and what gentle step will help next."})}),"thematic"===m&&t.jsxs("div",{className:"mb-6",children:[t.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Report Topic"}),t.jsx("input",{type:"text",value:b,onChange:e=>y(e.target.value),placeholder:"For example: Why am I not sleeping well?",className:"w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-700 bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white"})]}),t.jsx("div",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700/50 mb-6",children:t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:g,onChange:e=>p(e.target.checked),className:"mt-1 h-5 w-5 text-blue-600 rounded"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold text-white",children:"Include second opinion"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Get two different explanations: physiological and behavioral"})]})]})}),t.jsx("button",{onClick:u,className:"w-full py-4 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-600 shadow-lg shadow-orange-600/20 text-white rounded-lg font-semibold transition-colors",children:"Create Report"})]})}):t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16",children:t.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[t.jsx("button",{onClick:r,className:"mb-6 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"← Back"}),t.jsx("h1",{className:"text-3xl font-bold text-white mb-8",children:"Choose Report Type"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("button",{onClick:()=>{h("general"),x("options")},className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border-2 border-gray-200 dark:border-gray-800 hover:border-blue-500 dark:hover:border-blue-500 transition-all text-left group",children:[t.jsx(a,{className:"h-12 w-12 text-orange-500 mb-4 group-hover:scale-110 transition-transform"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"General State Report"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Learn what's happening with your body overall: sleep, energy, recovery, load adaptation"})]}),t.jsxs("button",{onClick:()=>{h("thematic"),x("options")},className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border-2 border-gray-200 dark:border-gray-800 hover:border-purple-500 dark:hover:border-purple-500 transition-all text-left group",children:[t.jsx(n,{className:"h-12 w-12 text-purple-600 dark:text-purple-400 mb-4 group-hover:scale-110 transition-transform"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Explore Specific Topic"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Deep analysis of one area: sleep, stress, recovery, nutrition, glucose"})]}),t.jsxs("button",{onClick:()=>{h("dynamic"),x("options")},className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border-2 border-gray-200 dark:border-gray-800 hover:border-green-500 dark:hover:border-green-500 transition-all text-left group",disabled:reports.length<2,children:[t.jsx(s,{className:"h-12 w-12 text-green-600 dark:text-green-400 mb-4 group-hover:scale-110 transition-transform"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"View Dynamics"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Compare state with previous reports and see trends"}),reports.length<2&&t.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-2",children:"Available after creating 2+ reports"})]}),t.jsxs("button",{onClick:()=>{h("device_enhanced"),x("options")},className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border-2 border-gray-200 dark:border-gray-800 hover:border-teal-500 dark:hover:border-teal-500 transition-all text-left group",children:[t.jsx(o,{className:"h-12 w-12 text-teal-600 dark:text-teal-400 mb-4 group-hover:scale-110 transition-transform"}),t.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Report with Device Data"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Complete analysis with automatic integration of metrics from your devices"})]})]})]})})}function g({report:e,onBack:r,onNavigate:a}){const[o,n]=d.useState("a");return t.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-950 transition-colors pt-16",children:t.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[t.jsx("button",{onClick:r,className:"mb-6 text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"← Back to Reports List"}),t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:e.topic||"State Report"}),t.jsx("p",{className:"text-gray-400",children:new Date(e.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:()=>{alert("PDF export will be implemented in the next version")},className:"inline-flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 text-white rounded-lg transition-colors",children:[t.jsx(l,{className:"h-5 w-5 mr-2"}),"PDF"]}),t.jsxs("button",{onClick:()=>{a("member-zone")},className:"inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[t.jsx(x,{className:"h-5 w-5 mr-2"}),"Discuss with AI"]})]})]})}),t.jsxs("div",{className:"space-y-8",children:[t.jsxs("section",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700/50",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Brief Summary"}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:e.summary})]}),e.insights&&Array.isArray(e.insights)&&e.insights.length>0&&t.jsxs("section",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700/50",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Key Insights"}),t.jsx("ul",{className:"space-y-3",children:e.insights.map((e,r)=>t.jsxs("li",{className:"flex items-start space-x-3",children:[t.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-orange-500 text-sm font-semibold",children:r+1}),t.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:e})]},r))})]}),t.jsxs("section",{className:"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-xl p-6 border border-gray-700/50",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Detailed Analysis"}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-line",children:e.analysis})]}),e.recommendations&&Array.isArray(e.recommendations)&&e.recommendations.length>0&&t.jsxs("section",{className:"bg-gradient-to-br from-green-50 to-teal-50 dark:from-green-900/20 dark:to-teal-900/20 rounded-xl p-6 border border-green-200 dark:border-green-800",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Gentle Steps for Improvement"}),t.jsx("div",{className:"space-y-4",children:e.recommendations.map((e,r)=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-white mb-2",children:e.title}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.description})]},r))})]}),e.second_opinion_a&&e.second_opinion_b&&t.jsxs("section",{className:"bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl p-6 border border-purple-200 dark:border-purple-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Second Opinion"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>n("a"),className:"px-3 py-1 rounded text-sm font-semibold transition-colors "+("a"===o?"bg-purple-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"),children:"Opinion A"}),t.jsx("button",{onClick:()=>n("b"),className:"px-3 py-1 rounded text-sm font-semibold transition-colors "+("b"===o?"bg-purple-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"),children:"Opinion B"}),t.jsx("button",{onClick:()=>n("both"),className:"px-3 py-1 rounded text-sm font-semibold transition-colors "+("both"===o?"bg-purple-600 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"),children:"Both"})]})]}),("a"===o||"both"===o)&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 mb-4",children:[t.jsx("h3",{className:"font-semibold text-white mb-2",children:"Opinion A (Physiology)"}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:e.second_opinion_a})]}),("b"===o||"both"===o)&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-white mb-2",children:"Opinion B (Lifestyle)"}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:e.second_opinion_b})]})]}),t.jsxs("section",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/20 dark:to-cyan-900/20 rounded-xl p-6 border-2 border-teal-200 dark:border-teal-800",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Want to turn recommendations into a plan?"}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"I'll help turn the report's findings into an action plan. I'll suggest gentle steps that realistically fit into your life."}),t.jsxs("button",{onClick:()=>{alert("Navigation to Goals System will be implemented in MODULE 06")},className:"inline-flex items-center px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors font-semibold",children:[t.jsx(s,{className:"h-5 w-5 mr-2"}),"Create Plan"]})]})]})]})})}export{m as default};
